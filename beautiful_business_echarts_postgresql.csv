title,datasource,query,visualization,unit,thresholds,w,h
Executive Revenue (Daily),,"SELECT DATE_TRUNC('day', order_time) AS time, SUM(amount_cents)/100.0 AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,currencyUSD,20000|50000,12,8
Executive Orders (Daily),,"SELECT DATE_TRUNC('day', order_time) AS time, COUNT(*)::numeric AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,short,200|600,12,6
Executive AOV (Stat),,"SELECT DATE_TRUNC('day', order_time) AS time, AVG(amount_cents)/100.0 AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,currencyUSD,60|120,6,6
Refund Rate (Gauge) %,,"SELECT DATE_TRUNC('day', order_time) AS time, (SUM(CASE WHEN status = 'refunded' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(*),0))::numeric AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,percent,2|5,6,6
Revenue 7d Moving Avg,,"WITH daily AS (SELECT DATE_TRUNC('day', order_time) AS d, SUM(amount_cents)/100.0 AS rev FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1) SELECT d AS time, AVG(rev) OVER (ORDER BY d ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS value FROM daily ORDER BY time",echarts-line,currencyUSD,,12,6
Cumulative Revenue,,"WITH daily AS (SELECT DATE_TRUNC('day', order_time) AS d, SUM(amount_cents)/100.0 AS rev FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1) SELECT d AS time, SUM(rev) OVER (ORDER BY d) AS value FROM daily ORDER BY time",echarts-line,currencyUSD,,12,6
Conversion Rate %,,"WITH sessions AS (SELECT DATE_TRUNC('day', started_at) AS d, COUNT(*) AS s FROM web_sessions WHERE started_at >= $__timeFrom() AND started_at <= $__timeTo() GROUP BY 1), orders AS (SELECT DATE_TRUNC('day', order_time) AS d, COUNT(*) AS o FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1) SELECT COALESCE(s.d, o.d) AS time, (COALESCE(o.o,0) * 100.0 / NULLIF(COALESCE(s.s,0),0))::numeric AS value FROM sessions s FULL OUTER JOIN orders o ON s.d = o.d ORDER BY time",echarts-line,percent,1|3,12,8
95th Percentile Order Value,,"SELECT DATE_TRUNC('day', order_time) AS time, PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY amount_cents)/100.0 AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,currencyUSD,,12,6
Revenue by Weekday (Topline),,"SELECT TO_CHAR(order_time, 'Dy') AS label, SUM(amount_cents)/100.0 AS value FROM orders GROUP BY 1 ORDER BY CASE TO_CHAR(order_time,'Dy') WHEN 'Mon' THEN 1 WHEN 'Tue' THEN 2 WHEN 'Wed' THEN 3 WHEN 'Thu' THEN 4 WHEN 'Fri' THEN 5 WHEN 'Sat' THEN 6 ELSE 7 END",echarts-bar,currencyUSD,,12,6
Orders by Hour (All-Time),,"SELECT DATE_PART('hour', order_time)::int AS label, COUNT(*)::numeric AS value FROM orders GROUP BY 1 ORDER BY 1",echarts-bar,short,,12,6
Repeat Purchase Rate %,,"WITH first_orders AS (SELECT customer_id, MIN(order_time) AS first_time FROM orders GROUP BY customer_id), repurch AS (SELECT DATE_TRUNC('day', o.order_time) AS d, COUNT(DISTINCT o.customer_id) AS c FROM orders o JOIN first_orders f ON o.customer_id = f.customer_id AND o.order_time > f.first_time WHERE o.order_time >= $__timeFrom() AND o.order_time <= $__timeTo() GROUP BY 1), custs AS (SELECT DATE_TRUNC('day', order_time) AS d, COUNT(DISTINCT customer_id) AS c FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1) SELECT COALESCE(custs.d, repurch.d) AS time, (COALESCE(repurch.c,0) * 100.0 / NULLIF(COALESCE(custs.c,0),0))::numeric AS value FROM custs FULL OUTER JOIN repurch ON custs.d = repurch.d ORDER BY time",echarts-line,percent,5|12,12,6
New vs Repeat Orders (Share) %,,"WITH first_orders AS (SELECT customer_id, MIN(order_time) AS first_time FROM orders GROUP BY customer_id), daily AS (SELECT DATE_TRUNC('day', o.order_time) AS d, SUM(CASE WHEN o.order_time <= f.first_time THEN 1 ELSE 0 END)::numeric AS new_orders, SUM(CASE WHEN o.order_time > f.first_time THEN 1 ELSE 0 END)::numeric AS repeat_orders FROM orders o JOIN first_orders f ON o.customer_id = f.customer_id WHERE o.order_time >= $__timeFrom() AND o.order_time <= $__timeTo() GROUP BY 1) SELECT d AS time, (repeat_orders * 100.0 / NULLIF(new_orders + repeat_orders,0))::numeric AS value FROM daily ORDER BY time",echarts-line,percent,30|60,12,6
Top Customers by Revenue,,"SELECT COALESCE(customer_id::text, 'Unknown') AS label, SUM(amount_cents)/100.0 AS value FROM orders GROUP BY customer_id ORDER BY value DESC LIMIT 10",echarts-bar,currencyUSD,,12,8
Avg Days Between Purchases,,"WITH diffs AS (SELECT customer_id, EXTRACT(EPOCH FROM (order_time - LAG(order_time) OVER (PARTITION BY customer_id ORDER BY order_time))) / 86400.0 AS days_between FROM orders) SELECT DATE_TRUNC('day', order_time) AS time, AVG(days_between) AS value FROM (SELECT o.order_time, EXTRACT(EPOCH FROM (o.order_time - LAG(o.order_time) OVER (PARTITION BY o.customer_id ORDER BY o.order_time))) / 86400.0 AS days_between FROM orders o WHERE o.order_time >= $__timeFrom() AND o.order_time <= $__timeTo()) x GROUP BY 1 ORDER BY time",echarts-line,short,,12,6
Refunds (Daily Count),,"SELECT DATE_TRUNC('day', order_time) AS time, SUM(CASE WHEN status = 'refunded' THEN 1 ELSE 0 END)::numeric AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,short,,12,6
High Value Orders (>$200) Count,,"SELECT DATE_TRUNC('day', order_time) AS time, SUM(CASE WHEN amount_cents >= 20000 THEN 1 ELSE 0 END)::numeric AS value FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,short,,12,6
AOV 7d Moving Avg,,"WITH daily AS (SELECT DATE_TRUNC('day', order_time) AS d, AVG(amount_cents)/100.0 AS aov FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1) SELECT d AS time, AVG(aov) OVER (ORDER BY d ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS value FROM daily ORDER BY time",echarts-line,currencyUSD,,12,6
Sessions (Daily),,"SELECT DATE_TRUNC('day', started_at) AS time, COUNT(*)::numeric AS value FROM web_sessions WHERE started_at >= $__timeFrom() AND started_at <= $__timeTo() GROUP BY 1 ORDER BY time",echarts-line,short,,12,6
Revenue per Session (RPS),,"WITH s AS (SELECT DATE_TRUNC('day', started_at) AS d, COUNT(*) AS sess FROM web_sessions WHERE started_at >= $__timeFrom() AND started_at <= $__timeTo() GROUP BY 1), o AS (SELECT DATE_TRUNC('day', order_time) AS d, SUM(amount_cents)/100.0 AS rev FROM orders WHERE order_time >= $__timeFrom() AND order_time <= $__timeTo() GROUP BY 1) SELECT COALESCE(s.d,o.d) AS time, (COALESCE(o.rev,0) / NULLIF(COALESCE(s.sess,0),0))::numeric AS value FROM s FULL OUTER JOIN o ON s.d = o.d ORDER BY time",echarts-line,currencyUSD,,12,6
